# ============================================================================
# AI BRADAA - COMPREHENSIVE ENVIRONMENT CONFIGURATION
# ============================================================================
# Last Updated: 2025-11-12 00:30 MYT (Asia/Kuala_Lumpur)
# Maintained By: AI Bradaa Development Team
# Purpose: Complete environment setup for all services and features
#
# CRITICAL: Copy this file to .env and fill in your actual values
# NEVER commit .env to version control (already in .gitignore)
# ============================================================================

# ============================================================================
# SECTION 1: APPLICATION BASICS
# ============================================================================
NODE_ENV=development
PORT=3000
APP_URL=http://localhost:3000

# Production URL (used for CORS, callbacks, etc.)
PRODUCTION_URL=https://aibradaa.com

# ============================================================================
# SECTION 2: DATABASE - NEON POSTGRESQL (Primary)
# ============================================================================
# Neon Serverless PostgreSQL (RECOMMENDED for production)
# Sign up: https://neon.tech (Free tier: 0.5GB storage, 1 compute unit)
# Connection pooling built-in, auto-scaling

# Neon Connection String (get from Neon dashboard)
DATABASE_URL=postgresql://user:password@ep-xxx.region.aws.neon.tech/dbname?sslmode=require

# Alternative format (if using individual params):
DB_HOST=ep-xxx.region.aws.neon.tech
DB_PORT=5432
DB_NAME=ai_bradaa
DB_USER=your_neon_user
DB_PASSWORD=your_neon_password
DB_SSL=true

# Connection Pool Settings (optimized for Neon serverless)
DB_POOL_MAX=20
DB_POOL_MIN=2
DB_POOL_IDLE_TIMEOUT_MS=30000
DB_POOL_CONNECTION_TIMEOUT_MS=5000

# Database Encryption (AES-256 for PII fields)
# Generate with: openssl rand -hex 32
DB_ENCRYPTION_KEY=your_64_character_hex_encryption_key_here_32_bytes

# ============================================================================
# SECTION 3: AUTHENTICATION & SECURITY
# ============================================================================

# JWT Configuration
# Generate secret with: openssl rand -base64 32
JWT_SECRET=your_jwt_secret_here_minimum_32_characters_required
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# Session Configuration
SESSION_SECRET=your_session_secret_here_different_from_jwt
SESSION_MAX_AGE_MS=604800000

# Password Policy
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true
BCRYPT_ROUNDS=10

# Account Security
MAX_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION_MS=900000
REQUIRE_EMAIL_VERIFICATION=true

# ============================================================================
# SECTION 4: OAUTH 2.0 PROVIDERS
# ============================================================================

# Google OAuth 2.0
# Get credentials: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=your_google_client_id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_REDIRECT_URI=http://localhost:3000/api/auth/google/callback

# Facebook OAuth (optional)
# FACEBOOK_APP_ID=your_facebook_app_id
# FACEBOOK_APP_SECRET=your_facebook_app_secret
# FACEBOOK_REDIRECT_URI=http://localhost:3000/api/auth/facebook/callback

# GitHub OAuth (optional)
# GITHUB_CLIENT_ID=your_github_client_id
# GITHUB_CLIENT_SECRET=your_github_client_secret
# GITHUB_REDIRECT_URI=http://localhost:3000/api/auth/github/callback

# ============================================================================
# SECTION 5: MAGIC LINK AUTHENTICATION
# ============================================================================
MAGIC_LINK_SECRET=your_magic_link_secret_different_from_jwt
MAGIC_LINK_EXPIRES_IN=15m
MAGIC_LINK_MAX_ATTEMPTS=3

# ============================================================================
# SECTION 6: EMAIL SERVICE - SENDGRID (Primary)
# ============================================================================
# SendGrid (RECOMMENDED - Free tier: 100 emails/day)
# Sign up: https://sendgrid.com
SENDGRID_API_KEY=SG.your_sendgrid_api_key_here
SENDGRID_FROM_EMAIL=noreply@aibradaa.com
SENDGRID_FROM_NAME=AI Bradaa

# Email Templates
SENDGRID_TEMPLATE_WELCOME=d-xxx
SENDGRID_TEMPLATE_MAGIC_LINK=d-xxx
SENDGRID_TEMPLATE_PASSWORD_RESET=d-xxx
SENDGRID_TEMPLATE_EMAIL_VERIFICATION=d-xxx
SENDGRID_TEMPLATE_TIER_UPGRADE=d-xxx

# Alternative: Custom SMTP (if not using SendGrid)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_SECURE=false
# SMTP_USER=your_email@gmail.com
# SMTP_PASS=your_app_specific_password

# ============================================================================
# SECTION 7: GOOGLE GEMINI AI API
# ============================================================================
# Get API key: https://aistudio.google.com/app/apikey
GEMINI_API_KEY=AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

# Model Selection (Gemini 2.5)
GEMINI_MODEL_FLASH=gemini-2.5-flash
GEMINI_MODEL_PRO=gemini-2.5-pro
GEMINI_MODEL_PRO_EXP=gemini-2.5-pro-exp

# Gemini Features
GEMINI_ENABLE_SEARCH_GROUNDING=true
GEMINI_ENABLE_THINKING_MODE=true
GEMINI_MAX_TOKENS=8192
GEMINI_TEMPERATURE=0.7

# ============================================================================
# SECTION 8: GOOGLE MAPS API (for store locations)
# ============================================================================
# Get API key: https://console.cloud.google.com/google/maps-apis
GOOGLE_MAPS_API_KEY=AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

# Maps Features
GOOGLE_MAPS_ENABLE_PLACES=true
GOOGLE_MAPS_ENABLE_GEOCODING=true
GOOGLE_MAPS_ENABLE_DISTANCE_MATRIX=true

# ============================================================================
# SECTION 9: PAYMENT PROCESSING - STRIPE
# ============================================================================
# Get keys: https://dashboard.stripe.com/apikeys
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_stripe_webhook_secret

# Stripe Price IDs (create in Stripe Dashboard → Products)
STRIPE_PRICE_ID_PRO_MONTHLY=price_xxx_pro_monthly_rm30
STRIPE_PRICE_ID_PRO_YEARLY=price_xxx_pro_yearly_rm300
STRIPE_PRICE_ID_ULTIMATE_MONTHLY=price_xxx_ultimate_monthly_rm80
STRIPE_PRICE_ID_ULTIMATE_YEARLY=price_xxx_ultimate_yearly_rm800

# Currency
STRIPE_CURRENCY=myr
STRIPE_ALLOW_PROMOTION_CODES=true

# ============================================================================
# SECTION 10: TIER SYSTEM & QUOTA MANAGEMENT
# ============================================================================

# --- FREE TIER (RM0/month) ---
FREE_TIER_TOKENS_MONTHLY=30000
FREE_TIER_REQUESTS_MONTHLY=50
FREE_TIER_COST_CEILING_MYR=8
FREE_TIER_RATE_LIMIT_PER_MINUTE=10

# --- PRO TIER (RM30/month) ---
PRO_TIER_TOKENS_MONTHLY=400000
PRO_TIER_REQUESTS_MONTHLY=800
PRO_TIER_COST_CEILING_MYR=40
PRO_TIER_RATE_LIMIT_PER_MINUTE=30
PRO_TIER_VOICE_MINUTES_DAILY=10
PRO_TIER_VISION_IMAGES_DAILY=5

# --- ULTIMATE TIER (RM80/month) ---
ULTIMATE_TIER_TOKENS_MONTHLY=3000000
ULTIMATE_TIER_REQUESTS_MONTHLY=5000
ULTIMATE_TIER_COST_CEILING_MYR=200
ULTIMATE_TIER_RATE_LIMIT_PER_MINUTE=60
ULTIMATE_TIER_VOICE_UNLIMITED=true
ULTIMATE_TIER_VISION_UNLIMITED=true

# Cost Tracking
GEMINI_COST_PER_1K_TOKENS_INPUT_MYR=0.00004
GEMINI_COST_PER_1K_TOKENS_OUTPUT_MYR=0.00012
EXCHANGE_RATE_USD_TO_MYR=4.45

# ============================================================================
# SECTION 11: ABO-84 BETA (AI Coding Assistant)
# ============================================================================

# Access Control
ABO84_BETA_SIGNUP_LIMIT=20
ABO84_BETA_PRO_DASHBOARD_ONLY=true
ABO84_BETA_ULTIMATE_FULL_ACCESS=true

# Download Tracking
ABO84_DOWNLOAD_WINDOWS_URL=https://downloads.aibradaa.com/abo84-beta-windows.exe
ABO84_DOWNLOAD_MACOS_URL=https://downloads.aibradaa.com/abo84-beta-macos.dmg
ABO84_DOWNLOAD_LINUX_URL=https://downloads.aibradaa.com/abo84-beta-linux.AppImage

# License Management
ABO84_LICENSE_VALIDITY_DAYS=365
ABO84_LICENSE_MAX_DEVICES=3

# ============================================================================
# SECTION 12: CATCHPHRASE SYSTEM V4.1
# ============================================================================

# Catchphrase Configuration
CATCHPHRASE_ENABLED=true
CATCHPHRASE_VERSION=4.1

# Rephrase Settings (70% minimum similarity)
CATCHPHRASE_REPHRASE_THRESHOLD=0.70
CATCHPHRASE_GEMINI_CONFIDENCE_MIN=0.75

# Daily Greeting
CATCHPHRASE_USE_YO_DAILY=true
CATCHPHRASE_USE_NAKAMA_WITH_NICKNAME=true

# Cache Settings
CATCHPHRASE_CACHE_TTL_MS=86400000
CATCHPHRASE_NEVER_REPEAT_LIMIT=50

# Manglish Integration
CATCHPHRASE_MANGLISH_FREQUENCY=100
CATCHPHRASE_MANGLISH_TERMS=lah,leh,lor,meh,kan,la,ma,ah

# Auto-Fetch (Daily 3:00 AM MYT)
CATCHPHRASE_AUTO_FETCH_ENABLED=true
CATCHPHRASE_AUTO_FETCH_CRON=0 3 * * *
CATCHPHRASE_AUTO_FETCH_BATCH_SIZE=10

# ============================================================================
# SECTION 13: DATA SYNC & AUTO-FETCH
# ============================================================================

# Laptop Data Sync
DATA_SYNC_INTERVAL_MS=21600000
DATA_SYNC_CACHE_TTL_MS=21600000
DATA_PRICE_CACHE_TTL_MS=1800000

# Auto-Refresh Schedule (cron format)
DATA_SYNC_CRON=0 */6 * * *

# Data Sources
DATA_SOURCE_SHOPEE_ENABLED=true
DATA_SOURCE_LAZADA_ENABLED=true
DATA_SOURCE_OFFICIAL_STORES_ENABLED=true

# ============================================================================
# SECTION 14: AFFILIATE PROGRAMS
# ============================================================================

# Shopee Affiliate
SHOPEE_AFFILIATE_ID=your_shopee_affiliate_id
SHOPEE_TRACKING_PREFIX=utm_source=aibradaa&utm_medium=affiliate

# Lazada Affiliate
LAZADA_AFFILIATE_KEY=your_lazada_affiliate_key
LAZADA_TRACKING_PREFIX=utm_source=aibradaa&utm_medium=affiliate

# Commission Tracking
AFFILIATE_COOKIE_DURATION_DAYS=30
AFFILIATE_COMMISSION_SHOPEE_PERCENTAGE=3
AFFILIATE_COMMISSION_LAZADA_PERCENTAGE=3

# ============================================================================
# SECTION 15: PWA (PROGRESSIVE WEB APP)
# ============================================================================

# VAPID Keys (for push notifications)
# Generate with: npx web-push generate-vapid-keys
PWA_VAPID_PUBLIC_KEY=your_vapid_public_key_base64
PWA_VAPID_PRIVATE_KEY=your_vapid_private_key_base64
PWA_CONTACT_EMAIL=admin@aibradaa.com

# Service Worker
PWA_SW_CACHE_VERSION=v1.0.0
PWA_SW_OFFLINE_PAGE=/offline.html
PWA_SW_CACHE_STATIC_TTL_MS=604800000
PWA_SW_CACHE_DYNAMIC_TTL_MS=86400000

# ============================================================================
# SECTION 16: ANALYTICS & MONITORING
# ============================================================================

# Google Analytics 4
GA4_TRACKING_ID=G-XXXXXXXXXX
GA4_ANONYMIZE_IP=true
GA4_COOKIE_FLAGS=SameSite=None;Secure
GA4_ALLOW_GOOGLE_SIGNALS=false

# Sentry (Error Tracking)
SENTRY_DSN=https://xxx@xxx.ingest.sentry.io/xxx
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_ENABLE_TRACING=true

# OpenTelemetry (OTEL)
OTEL_ENABLED=false
OTEL_EXPORTER_OTLP_ENDPOINT=https://otlp.example.com:4317
OTEL_EXPORTER_OTLP_TOKEN=your_otlp_token
OTEL_TRACES_SAMPLER_RATIO=1.0
OTEL_CAPTURE_PROMPTS=true
OTEL_LOG_LEVEL=info

# ============================================================================
# SECTION 17: SECURITY & COMPLIANCE
# ============================================================================

# CORS Configuration
CORS_ORIGIN=http://localhost:3000,https://aibradaa.com
CORS_CREDENTIALS=true
CORS_MAX_AGE_SECONDS=86400

# Content Security Policy (CSP)
CSP_ENABLED=true
CSP_REPORT_ONLY=false
CSP_REPORT_URI=/api/csp-report

# PDPA/GDPR Compliance
PDPA_CONSENT_REQUIRED=true
PDPA_DATA_RETENTION_DAYS=365
PDPA_AUTO_DELETE_ENABLED=true
PDPA_AUDIT_LOG_RETENTION_DAYS=2555

# Data Encryption (at rest)
ENCRYPTION_ALGORITHM=aes-256-gcm
ENCRYPTION_KEY_ROTATION_DAYS=90

# Security Headers
HSTS_MAX_AGE_SECONDS=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# ============================================================================
# SECTION 18: RATE LIMITING & ABUSE PREVENTION
# ============================================================================

# Global Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# IP-Based Rate Limiting
RATE_LIMIT_IP_MAX_REQUESTS=100
RATE_LIMIT_IP_WINDOW_MS=60000

# API-Specific Rate Limits (overrides tier limits for specific endpoints)
RATE_LIMIT_AI_CHAT_FREE=10
RATE_LIMIT_AI_CHAT_PRO=30
RATE_LIMIT_AI_CHAT_ULTIMATE=60

# DDoS Protection
DDOS_PROTECTION_ENABLED=true
DDOS_MAX_CONNECTIONS_PER_IP=50

# ============================================================================
# SECTION 19: CACHING LAYERS
# ============================================================================

# Memory Cache
CACHE_MEMORY_ENABLED=true
CACHE_MEMORY_MAX_SIZE_MB=100
CACHE_MEMORY_TTL_MS=3600000

# IndexedDB (Client-Side)
CACHE_INDEXEDDB_ENABLED=true
CACHE_INDEXEDDB_VERSION=2
CACHE_INDEXEDDB_TTL_MS=86400000

# Netlify Blobs (Server-Side)
CACHE_NETLIFY_BLOBS_ENABLED=true
CACHE_NETLIFY_BLOBS_TTL_MS=21600000

# Cache Strategies
CACHE_STRATEGY_LAPTOPS=cache-first
CACHE_STRATEGY_PRICES=network-first
CACHE_STRATEGY_INTEL=stale-while-revalidate

# ============================================================================
# SECTION 20: LOGGING
# ============================================================================

# Log Configuration
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_ENABLED=false
LOG_FILE_PATH=./logs/app.log
LOG_FILE_MAX_SIZE_MB=10
LOG_FILE_MAX_FILES=5

# Log PII Masking
LOG_MASK_EMAIL=true
LOG_MASK_IP=true
LOG_MASK_PASSWORDS=true

# Debug Mode (development only)
DEBUG=ai-bradaa:*
DEBUG_COLORS=true

# ============================================================================
# SECTION 21: FEATURE FLAGS
# ============================================================================

# Core Features
FEATURE_AUTH_OAUTH=true
FEATURE_AUTH_MAGIC_LINK=true
FEATURE_AUTH_EMAIL_PASSWORD=true

# AI Features
FEATURE_AI_CHAT=true
FEATURE_AI_VOICE=true
FEATURE_AI_VISION=true
FEATURE_AI_MAPS=true
FEATURE_AI_THINKING_MODE=true
FEATURE_AI_SEARCH_GROUNDING=true

# PWA Features
FEATURE_PWA_INSTALL_PROMPT=true
FEATURE_PWA_PUSH_NOTIFICATIONS=true
FEATURE_PWA_OFFLINE_MODE=true

# Product Features (Multi-Category)
FEATURE_LAPTOPS_ENABLED=true
FEATURE_CAMERAS_ENABLED=false
FEATURE_SMARTPHONES_ENABLED=false
FEATURE_GADGETS_ENABLED=false

# Beta Features
FEATURE_ABO84_BETA=true
FEATURE_INTEL_FEED=true
FEATURE_CAMERA_TECH=false

# Admin Features
FEATURE_ADMIN_DASHBOARD=true
FEATURE_SYEDDY_DEBUGGER=true

# ============================================================================
# SECTION 22: DOMAIN & DNS (Cloudflare)
# ============================================================================

# Domain Configuration (managed via Cloudflare)
DOMAIN_NAME=aibradaa.com
DOMAIN_REGISTRAR=dynadot
DNS_PROVIDER=cloudflare

# Cloudflare Settings
CLOUDFLARE_ZONE_ID=your_cloudflare_zone_id
CLOUDFLARE_API_TOKEN=your_cloudflare_api_token

# Email Routing (Cloudflare)
EMAIL_ROUTING_SUPPORT=support@aibradaa.com
EMAIL_ROUTING_FORWARD_TO=hoabymj@gmail.com

# ============================================================================
# SECTION 23: DEVELOPMENT & TESTING
# ============================================================================

# Development Mode
WATCH_FILES=true
HOT_RELOAD=true
DEVELOPMENT_STRICT_MODE=true

# Test Credentials
TEST_USER_EMAIL=test@example.com
TEST_USER_PASSWORD=TestPassword123!
TEST_ADMIN_EMAIL=admin@example.com
TEST_ADMIN_PASSWORD=AdminPassword123!

# Test Database (separate from production)
TEST_DATABASE_URL=postgresql://test:test@localhost:5432/ai_bradaa_test

# Playwright E2E Testing
PLAYWRIGHT_HEADLESS=true
PLAYWRIGHT_BASE_URL=http://localhost:3000

# ============================================================================
# SECTION 24: N8N WORKFLOW AUTOMATION (Optional)
# ============================================================================

# n8n Configuration (if using for automation)
N8N_ENABLED=false
N8N_HOST=localhost
N8N_PORT=5678
N8N_PROTOCOL=http
N8N_WEBHOOK_URL=http://localhost:5678/webhook

# n8n Workflows
N8N_WORKFLOW_CATCHPHRASE_AUTO_FETCH=your_workflow_id
N8N_WORKFLOW_DATA_SYNC=your_workflow_id
N8N_WORKFLOW_EMAIL_NOTIFICATIONS=your_workflow_id

# ============================================================================
# SECTION 25: CLOUD SERVICES (Future Expansion)
# ============================================================================

# AWS (if migrating from Netlify)
# AWS_REGION=ap-southeast-1
# AWS_ACCESS_KEY_ID=your_aws_access_key
# AWS_SECRET_ACCESS_KEY=your_aws_secret_key
# S3_BUCKET_NAME=ai-bradaa-assets

# Google Cloud Platform
# GOOGLE_CLOUD_PROJECT=your_gcp_project_id
# GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account.json

# Azure (optional)
# AZURE_SUBSCRIPTION_ID=your_azure_subscription_id
# AZURE_TENANT_ID=your_azure_tenant_id

# ============================================================================
# SECTION 26: BACKUP & DISASTER RECOVERY
# ============================================================================

# Database Backups (Neon has automatic backups)
BACKUP_ENABLED=true
BACKUP_SCHEDULE_CRON=0 2 * * *
BACKUP_RETENTION_DAYS=30

# Backup Storage
BACKUP_STORAGE_TYPE=s3
BACKUP_S3_BUCKET=ai-bradaa-backups
BACKUP_S3_REGION=ap-southeast-1

# ============================================================================
# END OF CONFIGURATION
# ============================================================================
# Total Environment Variables: 150+
# Required for Production: ~40
# Optional: ~110
#
# Setup Checklist:
# ✅ 1. Copy .env.example to .env
# ✅ 2. Fill in DATABASE_URL (Neon)
# ✅ 3. Fill in GEMINI_API_KEY
# ✅ 4. Fill in SENDGRID_API_KEY
# ✅ 5. Fill in JWT_SECRET (generate new)
# ✅ 6. Fill in STRIPE keys (for payments)
# ✅ 7. Fill in GOOGLE_CLIENT_ID (for OAuth)
# ✅ 8. Fill in PWA_VAPID keys (for push notifications)
# ✅ 9. Review tier limits
# ✅ 10. Enable required features
#
# For more info, see: /AGENT.md (Environment Setup section)
# ============================================================================
